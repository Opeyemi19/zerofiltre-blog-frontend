<div *ngIf="loading; else popupContent" class="min-w-[150px] min-h-[100px] flex items-center justify-center">
    <svg class="w-10 h-10 animate-spin text-primary-500" xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink" width="200px" height="200px" viewBox="0 0 100 100"
        preserveAspectRatio="xMidYMid">
        <circle cx="50" cy="50" fill="none" stroke="currentColor" stroke-width="8" r="35"
            stroke-dasharray="164.93361431346415 56.97787143782138" transform="matrix(1,0,0,1,0,0)"
            style="animation-play-state:paused"></circle>
    </svg>
</div>

<ng-template #popupContent>
    <div class="renewal-content-wrapper flex items-center justify-center px-5 pb-2">
        <div class="max-w-md w-full space-y-8">
            <div>
                <h2 class="text-center text-base lg:text-xl font-extrabold text-skin-base">
                    {{'passwordUpdatePopup.title' | translate}}
                </h2>
            </div>

            <form class="space-y-3" [formGroup]="form">
                <div>
                    <label for=" oldPassword" class="sr-only"> {{'passwordUpdatePopup.oldPassword | translate}}</label>
                    <div class="">
                        <div class="relative ">
                            <input name="oldPassword" type="password" id="oldPassword" required minlength="6"
                                formControlName="oldPassword" class=""
                                placeholder=" {{'passwordUpdatePopup.oldPassword' | translate}}">
                        </div>
                        <div *ngIf="oldPassword?.invalid && oldPassword?.dirty" class="">
                            <div *ngIf="oldPassword?.invalid" class="mt-1 text-xs sm:text-sm text-error italic">
                                {{'passwordUpdatePopup.oldPasswordError' | translate}}
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <label for=" password" class="sr-only">{{'app.password' | translate}}</label>
                    <div class="relative ">
                        <input name="password" type="password" id="password" required minlength="6"
                            formControlName="password" class=""
                            placeholder="{{'passwordUpdatePopup.newPassword' | translate}}">
                    </div>
                    <div *ngIf="password?.invalid && password?.dirty" class="">
                        <div *ngIf="password?.invalid" class="mt-1 text-xs sm:text-sm text-error italic">
                            {{'app.invalidPassword' | translate}}
                        </div>
                    </div>
                </div>

                <div>
                    <label for="matchingPassword" class="sr-only">{{'app.matchingPassword' | translate}}</label>
                    <div class="relative ">
                        <input name="matchingPassword" type="password" id="matchingPassword" required
                            formControlName="matchingPassword" class=""
                            placeholder="{{'app.matchingPassword' | translate}}">
                    </div>
                    <div *ngIf="!passwordDoesMatch() && matchingPassword?.dirty" class="">
                        <div *ngIf="!passwordDoesMatch()" class="mt-1 text-xs sm:text-sm text-error italic">
                            {{'app.passwordDoesNotMatch' | translate}}
                        </div>
                    </div>
                </div>

                <div class="action-buttons !mt-6 flex justify-center space-x-2">
                    <button *ngIf="passwordDoesMatch() && form.valid" (click)="handlePasswordUpdate()"
                        class="flex-1 border border-skin-border font-semibold py-2 px-4 text-sm rounded-full shadow-sm text-white bg-primary-300 hover:bg-primary-500">
                        <span>{{'app.save' | translate}}</span>
                    </button>
                    <button *ngIf="!passwordDoesMatch() || form.invalid" disabled
                        class="flex-1 border border-skin-border font-semibold py-2 px-4 text-sm rounded-full shadow-sm text-white bg-primary-300 opacity-20">
                        <span>{{'app.save' | translate}}</span>
                    </button>

                    <button (click)="onNoClick()"
                        class="flex-1 px-4 py-2 border border-skin-border rounded-full shadow-sm bg-skin-card text-sm leading-5 font-semibold text-skin-base hover:bg-skin-cardMuted transition-all duration-200">
                        <span>{{'app.cancel' | translate}}</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</ng-template>